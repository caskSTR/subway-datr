<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëœë¤ ì§€í•˜ì² ì—­ ë°ì´íŠ¸ ì½”ìŠ¤</title>
    <style>
        :root {
            --color-bg-base: #0f172a;
            --color-bg-elevated: #1e293b;
            --color-bg-surface: #334155;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-primary: #38bdf8;
            --color-primary-hover: #0ea5e9;
            --color-accent: #f472b6;
        }

        @media (prefers-color-scheme: light) {
            :root {
                --color-bg-base: #fcfcf9;
                --color-bg-elevated: #ffffff;
                --color-bg-surface: #f1f5f9;
                --color-text-primary: #0f172a;
                --color-text-secondary: #475569;
                --color-primary: #0284c7;
                --color-primary-hover: #0369a1;
                --color-accent: #ec4899;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--color-bg-base);
            color: var(--color-text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--color-text-secondary);
            font-size: 1rem;
        }

        .control-panel {
            background: var(--color-bg-elevated);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .line-selector {
            margin-bottom: 20px;
        }

        .line-selector label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--color-text-primary);
        }

        .line-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .line-btn {
            padding: 8px 16px;
            border: 2px solid var(--color-bg-surface);
            border-radius: 20px;
            background: var(--color-bg-base);
            color: var(--color-text-primary);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .line-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .line-btn.active {
            border-color: var(--color-primary);
            background: var(--color-primary);
            color: #0f172a;
        }

        .random-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .random-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(56, 189, 248, 0.4);
        }

        .random-btn:active {
            transform: translateY(0);
        }

        .result-card {
            background: var(--color-bg-elevated);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            animation: fadeIn 0.5s ease;
            margin-bottom: 30px;
        }

        .result-card.show {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .station-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--color-bg-surface);
        }

        .station-name {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--color-primary);
        }

        .line-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            color: white;
        }

        .course-section {
            margin-bottom: 30px;
        }

        .course-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .course-icon {
            font-size: 1.5rem;
        }

        .place-card {
            display: block;
            background: var(--color-bg-surface);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: transform 0.3s ease, box-shadow 0.2s ease;
            color: inherit;
            text-decoration: none;
        }

        .place-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.35);
        }

        .place-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--color-primary);
        }

        .place-desc {
            color: var(--color-text-secondary);
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .place-category {
            display: inline-block;
            padding: 4px 10px;
            background: var(--color-primary);
            color: #0f172a;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 8px;
        }

        .timeline {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid var(--color-bg-surface);
        }

        .timeline-item {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .timeline-time {
            min-width: 70px;
            font-weight: 700;
            color: var(--color-primary);
        }

        .timeline-content {
            flex: 1;
            color: var(--color-text-secondary);
        }

        .concept-panel {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--color-bg-surface);
            margin-bottom: 25px;
        }

        .concept-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--color-text-primary);
        }

        .concept-input {
            width: 100%;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid var(--color-bg-surface);
            background: var(--color-bg-base);
            color: var(--color-text-primary);
            margin-bottom: 10px;
        }

        .concept-helper {
            font-size: 0.85rem;
            color: var(--color-text-secondary);
            margin-bottom: 10px;
        }

        .concept-btns {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 10px;
        }

        .concept-chip {
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid var(--color-bg-surface);
            background: var(--color-bg-surface);
            color: var(--color-text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
        }

        .concept-chip:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .generate-course-btn {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: none;
            background: var(--color-primary);
            color: #0f172a;
            font-weight: 700;
            cursor: pointer;
            margin-top: 5px;
        }

        .generate-course-btn:disabled {
            opacity: 0.7;
            cursor: default;
        }

        #map {
            width: 100%;
            height: 320px;
            margin-bottom: 30px;
            border-radius: 12px;
            overflow: hidden;
            background: #0f172a;
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            h1 {
                font-size: 1.5rem;
            }

            .control-panel {
                padding: 20px;
            }

            .station-name {
                font-size: 1.5rem;
            }

            .timeline-item {
                flex-direction: column;
                gap: 5px;
            }

            .timeline-time {
                min-width: auto;
            }
        }
    </style>

    <!-- YOUR_JS_KEY ìë¦¬ì— ì¹´ì¹´ì˜¤ JavaScript í‚¤ ì…ë ¥ -->
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=8ac7cf6be5dc150b231d2ea6cb68e2c6&libraries=services"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸš‡ ëœë¤ ì§€í•˜ì² ì—­ ë°ì´íŠ¸ ì½”ìŠ¤</h1>
            <p class="subtitle">ì˜¤ëŠ˜ì€ ì–´ë””ë¡œ ë°ì´íŠ¸ ê°ˆê¹Œìš”? ìš´ëª…ì— ë§¡ê²¨ë³´ì„¸ìš”!</p>
        </header>

        <div class="control-panel">
            <div class="line-selector">
                <label>ì§€í•˜ì²  ë…¸ì„  ì„ íƒ (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</label>
                <div class="line-buttons">
                    <button class="line-btn active" data-line="all">ì „ì²´</button>
                    <button class="line-btn" data-line="1" style="background: #003DA5; color: white;">1í˜¸ì„ </button>
                    <button class="line-btn" data-line="2" style="background: #00A84D; color: white;">2í˜¸ì„ </button>
                    <button class="line-btn" data-line="3" style="background: #EF7C1C; color: white;">3í˜¸ì„ </button>
                    <button class="line-btn" data-line="4" style="background: #00A5DE; color: white;">4í˜¸ì„ </button>
                    <button class="line-btn" data-line="5" style="background: #996CAC; color: white;">5í˜¸ì„ </button>
                    <button class="line-btn" data-line="6" style="background: #CD7C2F; color: white;">6í˜¸ì„ </button>
                    <button class="line-btn" data-line="7" style="background: #747F00; color: white;">7í˜¸ì„ </button>
                    <button class="line-btn" data-line="9" style="background: #BDB092; color: white;">9í˜¸ì„ </button>
                </div>
            </div>
            <button class="random-btn" onclick="generateRandomStation()">âœ¨ ëœë¤ ì—­ ë½‘ê¸°</button>
        </div>

        <div class="result-card" id="resultCard">
            <div class="station-header">
                <h2 class="station-name" id="stationName"></h2>
                <span class="line-badge" id="lineBadge"></span>
            </div>

            <div class="concept-panel">
                <label class="concept-label">ì›í•˜ëŠ” ë°ì´íŠ¸ ì»¨ì…‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</label>
                <div class="concept-helper">
                    ì˜ˆì‹œ: ì¹´í˜ íˆ¬ì–´, ë§›ì§‘ íƒë°©, í•œê°• ì‚°ì±…, ì¡°ìš©í•œ íë§, ì‡¼í•‘ ìœ„ì£¼, ì•¼ê²½ ê°ìƒ, ë¬¸í™”Â·ì „ì‹œ ë°ì´íŠ¸ ë“±
                </div>
                <div class="concept-btns">
                    <button type="button" class="concept-chip" onclick="setConcept('ì¹´í˜ íˆ¬ì–´')">ì¹´í˜ íˆ¬ì–´</button>
                    <button type="button" class="concept-chip" onclick="setConcept('ë§›ì§‘ íƒë°©')">ë§›ì§‘ íƒë°©</button>
                    <button type="button" class="concept-chip" onclick="setConcept('í•œê°• ì‚°ì±…')">í•œê°• ì‚°ì±…</button>
                    <button type="button" class="concept-chip" onclick="setConcept('ì¡°ìš©í•œ íë§')">ì¡°ìš©í•œ íë§</button>
                    <button type="button" class="concept-chip" onclick="setConcept('ì•¼ê²½ ê°ìƒ')">ì•¼ê²½ ê°ìƒ</button>
                    <button type="button" class="concept-chip" onclick="setConcept('ë¬¸í™” ì „ì‹œ')">ë¬¸í™” ì „ì‹œ</button>
                </div>
                <input id="conceptInput" class="concept-input" placeholder="ì›í•˜ëŠ” ë°ì´íŠ¸ ì»¨ì…‰ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”" />
                <button class="generate-course-btn" id="generateCourseBtn" onclick="generateCourse()">ğŸ¯ ì´ ì»¨ì…‰ìœ¼ë¡œ ì½”ìŠ¤ ë§Œë“¤ê¸°</button>
            </div>

            <div id="map"></div>

            <div class="course-section">
                <h3 class="course-title">
                    <span class="course-icon">â˜•</span>
                    ì¶”ì²œ ì¹´í˜
                </h3>
                <div id="cafeList"></div>
            </div>

            <div class="course-section">
                <h3 class="course-title">
                    <span class="course-icon">ğŸ½ï¸</span>
                    ë§›ì§‘ ì¶”ì²œ
                </h3>
                <div id="restaurantList"></div>
            </div>

            <div class="course-section">
                <h3 class="course-title">
                    <span class="course-icon">ğŸ“¸</span>
                    ë°ì´íŠ¸ ëª…ì†Œ
                </h3>
                <div id="spotList"></div>
            </div>

            <div class="timeline">
                <h3 class="course-title">
                    <span class="course-icon">â°</span>
                    ì¶”ì²œ ì¼ì •
                </h3>
                <div id="scheduleList"></div>
            </div>
        </div>
    </div>

    <script>
        // ì„œìš¸ ì§€í•˜ì²  1~9í˜¸ì„  ì „ì²´ ì—­ ëª©ë¡
        const allStations = {
            '1': ['ì†Œìš”ì‚°','ë™ë‘ì²œ','ë³´ì‚°','ë™ë‘ì²œì¤‘ì•™','ì§€í–‰','ë•ì •','ë•ê³„','ì–‘ì£¼','ë…¹ì–‘','ê°€ëŠ¥','ì˜ì •ë¶€','íšŒë£¡','ë§ì›”ì‚¬','ë„ë´‰ì‚°','ë„ë´‰','ë°©í•™','ì°½ë™','ë…¹ì²œ','ì›”ê³„','ê´‘ìš´ëŒ€','ì„ê³„','ì‹ ì´ë¬¸','ì™¸ëŒ€ì•','íšŒê¸°','ì²­ëŸ‰ë¦¬','ì œê¸°ë™','ì‹ ì„¤ë™','ë™ë¬˜ì•','ë™ëŒ€ë¬¸','ì¢…ë¡œ5ê°€','ì¢…ë¡œ3ê°€','ì¢…ê°','ì‹œì²­','ì„œìš¸ì—­','ë‚¨ì˜','ìš©ì‚°','ë…¸ëŸ‰ì§„','ëŒ€ë°©','ì‹ ê¸¸','ì˜ë“±í¬','ì‹ ë„ë¦¼','êµ¬ë¡œ','êµ¬ì¼','ê°œë´‰','ì˜¤ë¥˜ë™','ì˜¨ìˆ˜','ì—­ê³¡','ì†Œì‚¬','ë¶€ì²œ','ì¤‘ë™','ì†¡ë‚´','ë¶€ê°œ','ë¶€í‰','ë°±ìš´','ë™ì•”','ê°„ì„','ì£¼ì•ˆ','ë„í™”','ì œë¬¼í¬','ë„ì›','ë™ì¸ì²œ','ì¸ì²œ'],
            '2': ['ì‹œì²­','ì„ì§€ë¡œì…êµ¬','ì„ì§€ë¡œ3ê°€','ì„ì§€ë¡œ4ê°€','ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›','ì‹ ë‹¹','ìƒì™•ì‹­ë¦¬','ì™•ì‹­ë¦¬','í•œì–‘ëŒ€','ëšì„¬','ì„±ìˆ˜','ê±´ëŒ€ì…êµ¬','êµ¬ì˜','ê°•ë³€','ì ì‹¤ë‚˜ë£¨','ì ì‹¤','ì ì‹¤ìƒˆë‚´','ì¢…í•©ìš´ë™ì¥','ì‚¼ì„±','ì„ ë¦‰','ì—­ì‚¼','ê°•ë‚¨','êµëŒ€','ì„œì´ˆ','ë°©ë°°','ì‚¬ë‹¹','ë‚™ì„±ëŒ€','ì„œìš¸ëŒ€ì…êµ¬','ë´‰ì²œ','ì‹ ë¦¼','ì‹ ëŒ€ë°©','êµ¬ë¡œë””ì§€í„¸ë‹¨ì§€','ëŒ€ë¦¼','ì‹ ë„ë¦¼','ë¬¸ë˜','ì˜ë“±í¬êµ¬ì²­','ë‹¹ì‚°','í•©ì •','í™ëŒ€ì…êµ¬','ì‹ ì´Œ','ì´ëŒ€','ì•„í˜„','ì¶©ì •ë¡œ'],
            '3': ['ëŒ€í™”','ì£¼ì—½','ì •ë°œì‚°','ë§ˆë‘','ë°±ì„','ëŒ€ê³¡','í™”ì •','ì›ë‹¹','ì›í¥','ì‚¼ì†¡','ì§€ì¶•','êµ¬íŒŒë°œ','ì—°ì‹ ë‚´','ë¶ˆê´‘','ë…¹ë²ˆ','í™ì œ','ë¬´ì•…ì¬','ë…ë¦½ë¬¸','ê²½ë³µê¶','ì•ˆêµ­','ì¢…ë¡œ3ê°€','ì„ì§€ë¡œ3ê°€','ì¶©ë¬´ë¡œ','ë™ëŒ€ì…êµ¬','ì•½ìˆ˜','ê¸ˆí˜¸','ì˜¥ìˆ˜','ì••êµ¬ì •','ì‹ ì‚¬','ì ì›','ê³ ì†í„°ë¯¸ë„','êµëŒ€','ë‚¨ë¶€í„°ë¯¸ë„','ì–‘ì¬','ë§¤ë´‰','ë„ê³¡','ëŒ€ì¹˜','í•™ì—¬ìš¸','ëŒ€ì²­','ì¼ì›','ìˆ˜ì„œ','ê°€ë½ì‹œì¥','ê²½ì°°ë³‘ì›','ì˜¤ê¸ˆ'],
            '4': ['ë‹¹ê³ ê°œ','ìƒê³„','ë…¸ì›','ì°½ë™','ìŒë¬¸','ìˆ˜ìœ ','ë¯¸ì•„','ë¯¸ì•„ì‚¬ê±°ë¦¬','ê¸¸ìŒ','ì„±ì‹ ì—¬ëŒ€ì…êµ¬','í•œì„±ëŒ€ì…êµ¬','í˜œí™”','ë™ëŒ€ë¬¸','ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›','ì¶©ë¬´ë¡œ','ëª…ë™','íšŒí˜„','ì„œìš¸ì—­','ìˆ™ëŒ€ì…êµ¬','ì‚¼ê°ì§€','ì‹ ìš©ì‚°','ì´ì´Œ','ë™ì‘','ì´ì‹ ëŒ€ì…êµ¬','ì‚¬ë‹¹','ë‚¨íƒœë ¹','ì„ ë°”ìœ„','ê²½ë§ˆê³µì›','ëŒ€ê³µì›','ê³¼ì²œ','ì •ë¶€ê³¼ì²œì²­ì‚¬','ì¸ë•ì›','í‰ì´Œ','ë²”ê³„','ê¸ˆì •','ì‚°ë³¸','ìˆ˜ë¦¬ì‚°','ëŒ€ì•¼ë¯¸','ë°˜ì›”','ìƒë¡ìˆ˜','í•œëŒ€ì•','ì¤‘ì•™','ê³ ì”','ì´ˆì§€','ì•ˆì‚°','ì‹ ê¸¸ì˜¨ì²œ','ì •ì™•','ì˜¤ì´ë„'],
            '5': ['ë°©í™”','ê°œí™”ì‚°','ê¹€í¬ê³µí•­','ì†¡ì •','ë§ˆê³¡','ë°œì‚°','ìš°ì¥ì‚°','í™”ê³¡','ê¹Œì¹˜ì‚°','ì‹ ì •','ëª©ë™','ì˜¤ëª©êµ','ì–‘í‰','ì˜ë“±í¬êµ¬ì²­','ì˜ë“±í¬ì‹œì¥','ì‹ ê¸¸','ì—¬ì˜ë„','ì—¬ì˜ë‚˜ë£¨','ë§ˆí¬','ê³µë•','ì• ì˜¤ê°œ','ì¶©ì •ë¡œ','ì„œëŒ€ë¬¸','ê´‘í™”ë¬¸','ì¢…ë¡œ3ê°€','ì„ì§€ë¡œ4ê°€','ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›','ì²­êµ¬','ì‹ ê¸ˆí˜¸','í–‰ë‹¹','ì™•ì‹­ë¦¬','ë§ˆì¥','ë‹µì‹­ë¦¬','ì¥í•œí‰','êµ°ì','ì•„ì°¨ì‚°','ê´‘ë‚˜ë£¨','ì²œí˜¸','ê°•ë™','ê¸¸ë™','êµ½ì€ë‹¤ë¦¬','ëª…ì¼','ê³ ë•','ìƒì¼ë™','í•˜ë‚¨í’ì‚°','í•˜ë‚¨ì‹œì²­','í•˜ë‚¨ê²€ë‹¨ì‚°'],
            '6': ['ì‘ì•”','ì—­ì´Œ','ë¶ˆê´‘','ë…ë°”ìœ„','ì—°ì‹ ë‚´','êµ¬ì‚°','ìƒˆì ˆ','ì¦ì‚°','ë””ì§€í„¸ë¯¸ë””ì–´ì‹œí‹°','ì›”ë“œì»µê²½ê¸°ì¥','ë§ˆí¬êµ¬ì²­','ë§ì›','í•©ì •','ìƒìˆ˜','ê´‘í¥ì°½','ëŒ€í¥','ê³µë•','íš¨ì°½ê³µì›ì•','ì‚¼ê°ì§€','ë…¹ì‚¬í‰','ì´íƒœì›','í•œê°•ì§„','ë²„í‹°ê³ ê°œ','ì•½ìˆ˜','ì²­êµ¬','ì‹ ë‹¹','ë™ë¬˜ì•','ì°½ì‹ ','ë³´ë¬¸','ì•ˆì•”','ê³ ë ¤ëŒ€','ì›”ê³¡','ìƒì›”ê³¡','ëŒê³¶ì´','ì„ê³„','íƒœë¦‰ì…êµ¬','í™”ë‘ëŒ€','ë´‰í™”ì‚°'],
            '7': ['ì¥ì•”','ë„ë´‰ì‚°','ìˆ˜ë½ì‚°','ë§ˆë“¤','ë…¸ì›','ì¤‘ê³„','í•˜ê³„','ê³µë¦‰','íƒœë¦‰ì…êµ¬','ë¨¹ê³¨','ì¤‘í™”','ìƒë´‰','ë©´ëª©','ì‚¬ê°€ì •','ìš©ë§ˆì‚°','ì¤‘ê³¡','êµ°ì','ì–´ë¦°ì´ëŒ€ê³µì›','ê±´ëŒ€ì…êµ¬','ëšì„¬ìœ ì›ì§€','ì²­ë‹´','ê°•ë‚¨êµ¬ì²­','í•™ë™','ë…¼í˜„','ë°˜í¬','ê³ ì†í„°ë¯¸ë„','ë‚´ë°©','ì´ìˆ˜','ë‚¨ì„±','ìˆ­ì‹¤ëŒ€ì…êµ¬','ìƒë„','ì¥ìŠ¹ë°°ê¸°','ì‹ ëŒ€ë°©ì‚¼ê±°ë¦¬','ë³´ë¼ë§¤','ì‹ í’','ëŒ€ë¦¼','ë‚¨êµ¬ë¡œ','ê°€ì‚°ë””ì§€í„¸ë‹¨ì§€','ì² ì‚°','ê´‘ëª…ì‚¬ê±°ë¦¬','ì²œì™•','ì˜¨ìˆ˜','ê¹Œì¹˜ìš¸','ë¶€ì²œì¢…í•©ìš´ë™ì¥','ì¶˜ì˜','ì‹ ì¤‘ë™','ë¶€ì²œì‹œì²­','ìƒë™','ì‚¼ì‚°ì²´ìœ¡ê´€','êµ´í¬ì²œ','ë¶€í‰êµ¬ì²­'],
            '9': ['ê°œí™”','ê¹€í¬ê³µí•­','ê³µí•­ì‹œì¥','ì‹ ë°©í™”','ë§ˆê³¡ë‚˜ë£¨','ì–‘ì²œí–¥êµ','ê°€ì–‘','ì¦ë¯¸','ë“±ì´Œ','ì—¼ì°½','ì‹ ëª©ë™','ì„ ìœ ë„','ë‹¹ì‚°','êµ­íšŒì˜ì‚¬ë‹¹','ì—¬ì˜ë„','ìƒ›ê°•','ë…¸ëŸ‰ì§„','ë…¸ë“¤','í‘ì„','ë™ì‘','êµ¬ë°˜í¬','ì‹ ë°˜í¬','ê³ ì†í„°ë¯¸ë„','ì‚¬í‰','ì‹ ë…¼í˜„','ì–¸ì£¼','ì„ ì •ë¦‰','ì‚¼ì„±ì¤‘ì•™','ë´‰ì€ì‚¬','ì¢…í•©ìš´ë™ì¥','ì‚¼ì „','ì„ì´Œê³ ë¶„','ì„ì´Œ','ì†¡íŒŒë‚˜ë£¨','í•œì„±ë°±ì œ','ì˜¬ë¦¼í”½ê³µì›','ë‘”ì´Œì˜¤ë¥œ','ì¤‘ì•™ë³´í›ˆë³‘ì›']
        };

        let selectedLines = ['all'];
        let currentStation = null;
        let currentLine = null;

        let map;
        let placesService;
        let mapInitialized = false;
        let markers = [];

        document.querySelectorAll('.line-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const line = this.dataset.line;
                
                if (line === 'all') {
                    selectedLines = ['all'];
                    document.querySelectorAll('.line-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                } else {
                    const allBtn = document.querySelector('[data-line="all"]');
                    allBtn.classList.remove('active');
                    
                    if (selectedLines.includes('all')) {
                        selectedLines = [];
                    }
                    
                    if (selectedLines.includes(line)) {
                        selectedLines = selectedLines.filter(l => l !== line);
                        this.classList.remove('active');
                    } else {
                        selectedLines.push(line);
                        this.classList.add('active');
                    }
                    
                    if (selectedLines.length === 0) {
                        selectedLines = ['all'];
                        allBtn.classList.add('active');
                    }
                }
            });
        });

        function initMap() {
            if (mapInitialized) return;

            const mapContainer = document.getElementById('map');
            if (!mapContainer) return;

            const options = {
                center: new kakao.maps.LatLng(37.5665, 126.9780),
                level: 5
            };
            map = new kakao.maps.Map(mapContainer, options);
            placesService = new kakao.maps.services.Places(map);
            mapInitialized = true;
        }

        function clearMarkers() {
            markers.forEach(m => m.setMap(null));
            markers = [];
        }

        function setConcept(text) {
            const input = document.getElementById('conceptInput');
            input.value = text;
        }

        function generateRandomStation() {
            let line;
            if (selectedLines.includes('all')) {
                const lines = Object.keys(allStations);
                line = lines[Math.floor(Math.random() * lines.length)];
            } else {
                line = selectedLines[Math.floor(Math.random() * selectedLines.length)];
            }

            if (!allStations[line] || allStations[line].length === 0) {
                alert('ì„ íƒëœ ë…¸ì„ ì— ì—­ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }

            const stations = allStations[line];
            const randomStationName = stations[Math.floor(Math.random() * stations.length)];

            currentStation = randomStationName;
            currentLine = line;

            showStationOnly(randomStationName, line);
        }

        function showStationOnly(stationName, line) {
            const lineColors = {
                '1': '#003DA5',
                '2': '#00A84D',
                '3': '#EF7C1C',
                '4': '#00A5DE',
                '5': '#996CAC',
                '6': '#CD7C2F',
                '7': '#747F00',
                '9': '#BDB092'
            };

            document.getElementById('stationName').textContent = ${stationName}ì—­;
            const lineBadge = document.getElementById('lineBadge');
            lineBadge.textContent = `${line}í˜¸ì„ `;
            lineBadge.style.backgroundColor = lineColors[line];

            document.getElementById('cafeList').innerHTML = `
                <div class="place-card">
                    <div class="place-name">ì»¨ì…‰ì„ ì…ë ¥í•˜ë©´ ì½”ìŠ¤ë¥¼ ë§Œë“¤ì–´ ë“œë¦´ê²Œìš”</div>
                    <div class="place-desc">ìœ„ì˜ ì…ë ¥ë€ì— ì›í•˜ëŠ” ë°ì´íŠ¸ ì»¨ì…‰ì„ ì ê³ , "ì´ ì»¨ì…‰ìœ¼ë¡œ ì½”ìŠ¤ ë§Œë“¤ê¸°" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>
                </div>
            `;
            document.getElementById('restaurantList').innerHTML = '';
            document.getElementById('spotList').innerHTML = '';
            document.getElementById('scheduleList').innerHTML = '';

            const resultCard = document.getElementById('resultCard');
            resultCard.classList.remove('show');
            setTimeout(() => {
                resultCard.classList.add('show');
                resultCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                initMap();
                clearMarkers();
            }, 100);
        }

        function buildSearchKeywords(concept, stationName) {
            const c = concept;
            const keywords = {
                cafe: `${stationName} ì¹´í˜`,
                food: `${stationName} ë§›ì§‘`,
                spot: `${stationName} ë°ì´íŠ¸`
            };

            if (c.includes('ì¹´í˜')) {
                keywords.cafe = `${stationName} ê°ì„± ì¹´í˜`;
            }
            if (c.includes('ë§›ì§‘') || c.includes('ì‹ì‚¬')) {
                keywords.food = `${stationName} ë§›ì§‘`;
            }
            if (c.includes('ì‚°ì±…') || c.includes('í•œê°•') || c.includes('íë§')) {
                keywords.spot = `${stationName} ê³µì›`;
            }
            if (c.includes('ì•¼ê²½')) {
                keywords.spot = `${stationName} ì•¼ê²½`;
            }
            if (c.includes('ì „ì‹œ') || c.includes('ë¬¸í™”')) {
                keywords.spot = `${stationName} ì „ì‹œ`;
            }

            return keywords;
        }

        function generateCourse() {
            if (!currentStation || !currentLine) {
                alert('ë¨¼ì € ëœë¤ ì—­ì„ ë½‘ì•„ì£¼ì„¸ìš”!');
                return;
            }

            const conceptInput = document.getElementById('conceptInput');
            const concept = conceptInput.value.trim();
            if (!concept) {
                alert('ë°ì´íŠ¸ ì»¨ì…‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                conceptInput.focus();
                return;
            }

            initMap();
            clearMarkers();

            const btn = document.getElementById('generateCourseBtn');
            btn.textContent = 'ğŸ” ì¹´ì¹´ì˜¤ ì§€ë„ì—ì„œ ì½”ìŠ¤ ê²€ìƒ‰ ì¤‘...';
            btn.disabled = true;

            const { cafe, food, spot } = buildSearchKeywords(concept, currentStation);

            const loadingHTML = (label) => `
                <div class="place-card">
                    <div class="place-name">ğŸ” "${concept}" ì»¨ì…‰ ${label} ê²€ìƒ‰ ì¤‘...</div>
                    <div class="place-desc">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!</div>
                </div>
            `;
            document.getElementById('cafeList').innerHTML = loadingHTML('ì¹´í˜');
            document.getElementById('restaurantList').innerHTML = loadingHTML('ë§›ì§‘');
            document.getElementById('spotList').innerHTML = loadingHTML('ëª…ì†Œ');

            document.getElementById('scheduleList').innerHTML = `
                <div class="timeline-item">
                    <div class="timeline-time">â³</div>
                    <div class="timeline-content">ì‹¤ì œ ì¥ì†Œ ê¸°ì¤€ìœ¼ë¡œ ì¼ì •ì„ ì§œëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
                </div>
            `;

            searchPlacesByKeyword(cafe, 'cafeList', 'ì¹´í˜', () => {
                searchPlacesByKeyword(food, 'restaurantList', 'ë§›ì§‘', () => {
                    searchPlacesByKeyword(spot, 'spotList', 'ëª…ì†Œ', () => {
                        const schedule = generateSchedule(currentStation, concept);
                        document.getElementById('scheduleList').innerHTML = schedule.map(item => `
                            <div class="timeline-item">
                                <div class="timeline-time">${item.time}</div>
                                <div class="timeline-content">${item.activity}</div>
                            </div>
                        `).join('');
                        btn.textContent = 'ğŸ¯ ì´ ì»¨ì…‰ìœ¼ë¡œ ì½”ìŠ¤ ë‹¤ì‹œ ë§Œë“¤ê¸°';
                        btn.disabled = false;
                    });
                });
            });
        }

        function searchPlacesByKeyword(keyword, targetElementId, label, done) {
            if (!placesService) {
                alert('ì¹´ì¹´ì˜¤ ì§€ë„ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                done && done();
                return;
            }

            const callback = function (data, status, pagination) {
                if (status === kakao.maps.services.Status.OK) {
                    const top = data.slice(0, 5);
                    const bounds = new kakao.maps.LatLngBounds();

                    const listHTML = top.map(place => {
                        const lat = place.y;
                        const lng = place.x;
                        const title = place.place_name;
                        const addr = place.road_address_name || place.address_name;
                        const id = place.id; // place id[web:76][web:119]

                        const position = new kakao.maps.LatLng(lat, lng);
                        bounds.extend(position);

                        const marker = new kakao.maps.Marker({
                            map: map,
                            position: position
                        });
                        markers.push(marker);

                        const iwContent = `<div style="padding:5px;font-size:12px;">${title}</div>`;
                        const infowindow = new kakao.maps.InfoWindow({
                            content: iwContent
                        });
                        kakao.maps.event.addListener(marker, 'mouseover', function () {
                            infowindow.open(map, marker);
                        });
                        kakao.maps.event.addListener(marker, 'mouseout', function () {
                            infowindow.close();
                        });

                        // ì¥ì†Œ ìƒì„¸ í˜ì´ì§€ ìˆìœ¼ë©´ place.map.kakao.com/id ë¡œ,
                        // ì—†ë‹¤ë©´ ê²€ìƒ‰ í˜ì´ì§€ë¡œ ì—°ê²°.[web:76][web:119]
                        const placeUrl = id
                            ? `https://place.map.kakao.com/${id}`
                            : `https://map.kakao.com/?q=${encodeURIComponent(title)}`;

                        return `
                            <a class="place-card" href="${placeUrl}" target="_blank" rel="noopener noreferrer">
                                <div class="place-name">${title}</div>
                                <div class="place-desc">
                                    ${addr ? addr + ' Â· ' : ''}"${keyword}" ê²€ìƒ‰ ê²°ê³¼ì—ì„œ ì¶”ì²œëœ ${label}ì…ë‹ˆë‹¤.
                                    (í´ë¦­ ì‹œ ì¹´ì¹´ì˜¤ë§µìœ¼ë¡œ ì´ë™)
                                </div>
                                <span class="place-category">${label}</span>
                            </a>
                        `;
                    }).join('');

                    document.getElementById(targetElementId).innerHTML = listHTML;
                    if (!bounds.isEmpty()) {
                        map.setBounds(bounds);
                    }
                } else {
                    document.getElementById(targetElementId).innerHTML = `
                        <div class="place-card">
                            <div class="place-name">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                            <div class="place-desc">"${keyword}"(ìœ¼)ë¡œ ${label}ì„(ë¥¼) ì°¾ì§€ ëª»í–ˆì–´ìš”. ë‹¤ë¥¸ ì»¨ì…‰ì´ë‚˜ ì—­ìœ¼ë¡œ ì‹œë„í•´ë³´ì„¸ìš”.</div>
                        </div>
                    `;
                }
                done && done();
            };

            placesService.keywordSearch(keyword, callback);
        }

        function generateSchedule(stationName, concept) {
            return [
                { time: '12:00', activity: `${stationName}ì—­ ë„ì°© Â· ì£¼ë³€ ë¶„ìœ„ê¸° ìµíˆë©° ê°€ë³ê²Œ ì‚°ì±…` },
                { time: '13:00', activity: `"${concept}" ì»¨ì…‰ì— ë§ëŠ” ì²« ë²ˆì§¸ ì¹´í˜/ë§›ì§‘ ë°©ë¬¸` },
                { time: '15:00', activity: `ê·¼ì²˜ ë°ì´íŠ¸ ëª…ì†Œì—ì„œ êµ¬ê²½ ë° ì‚¬ì§„ ì°ê¸°` },
                { time: '17:00', activity: `ì¡°ìš©í•œ ì¹´í˜ ë˜ëŠ” ê³µì›ì—ì„œ ì—¬ìœ ë¡œìš´ ì‹œê°„ ë³´ë‚´ê¸°` },
                { time: '19:00', activity: `ì €ë… ì‹ì‚¬ í›„ ${stationName} ì£¼ë³€ ì•¼ê°„ ë¶„ìœ„ê¸° ì¦ê¸°ë©° ë°ì´íŠ¸ ë§ˆë¬´ë¦¬` }
            ];
        }
    </script>
</body>
</html>




